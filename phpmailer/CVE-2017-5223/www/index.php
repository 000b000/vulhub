<?php
require 'vendor/autoload.php';

use PHPMailer\PHPMailer\PHPMailer;

if (isset($_POST['your-name'], $_POST['your-email'], $_POST['your-message'])) {
    $mail = new PHPMailer();
    $mail->SetFrom($_POST["your-email"], $_POST["your-name"]);
    $address = "admin@localhost";
    $mail->AddAddress($address, "root");
    if (isset($_POST['cc'])) $mail->AddCC($_POST["your-email"], $_POST["your-name"]);
    $mail->Subject = "PHPMailer <= 5.2.21 - Local File Disclosure (CVE-2017-5223)";
    $mail->MsgHTML($_POST["your-message"]);
    if(!$mail->Send()) echo "Error: ".$mail->ErrorInfo; else echo "Sent!";
}
?>
<form action="/contact.php" method="post">
<p><label>Your Name<br /><input type="text" name="your-name" value="" size="40" /></span> </label></p>
<p><label>Your Email<br /><input type="email" name="your-email" value="" size="40" /></span> </label></p>
<p><label>Your Message<br /><textarea name="your-message" cols="40" rows="10"></textarea></label></p>
<p><input type="checkbox" name="cc" value="yes" /><span>Send me a copy of this message</span>
<p><input type="submit" value="submit" /></p>