FROM vulhub/tomcat:8.5.19

MAINTAINER phithon <root@leavesongs.com>

RUN cd /usr/local/tomcat/conf \
    && LINE=$(nl -ba web.xml | grep '<load-on-startup>1' | awk '{print $1}') \
    && ADDON="\t<init-param>\n\t\t<param-name>readonly</param-name>\n\t\t<param-value>false</param-value>\n\t</init-param>" \
    && sed -i "$LINE i $ADDON" web.xml