FROM vulhub/tomcat:8.5.19

MAINTAINER phithon <root@leavesongs.com>

RUN cd /usr/local/tomcat/conf \
    && LINE=$(nl -ba web.xml | grep '<load-on-startup>1' | awk '{print $1}') \
    && ADDON="<init-param><param-name>readonly</param-name><param-value>false</param-value></init-param>" \
    && sed -i "$LINE i $ADDON" web.xml \
    && rm -rf /usr/local/tomcat/webapps/* \
    && mkdir /usr/local/tomcat/webapps/ROOT/ \
    && echo "HELLO" > /usr/local/tomcat/webapps/ROOT/index.html