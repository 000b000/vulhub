FROM python:3.6

LABEL maintainer="christa <christa0584@gmail.com>"
ENV ORACLE_HOME=/tmp/libs/lib  LD_LIBRARY_PATH=/tmp/libs/lib  VERSION=19.6.0.0.0 ARCH=x86_64


RUN set -ex \
    && apt-get update && apt-get upgrade -y \
    && apt-get install gcc g++ make binutils libproj-dev gdal-bin libaio1 libaio-dev -y

COPY libs/ /tmp/libs/
RUN pip install cx_Oracle==5.3 django==3.0.3

ADD https://raw.githubusercontent.com/vishnubob/wait-for-it/master/wait-for-it.sh /usr/local/bin/wait-for-it.sh
RUN chmod +x /usr/local/bin/wait-for-it.sh

COPY src/ /usr/src/
ADD docker-entrypoint.sh /docker-entrypoint.sh
RUN chmod +x /docker-entrypoint.sh

WORKDIR /usr/src
ENTRYPOINT [ "/docker-entrypoint.sh"]

CMD [ "python", "manage.py", "runserver", "0.0.0.0:8000" ]